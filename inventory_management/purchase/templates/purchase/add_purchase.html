{% extends 'base.html' %}

{% block title %}Purchase Form{% endblock %}

{% block content %}
<div class="container mt-5">
    <h1>Purchase Entry</h1>
    <form id="purchaseForm" method="POST" class="mt-4">
        {% csrf_token %}
        
        <!-- Row for Invoice No and Invoice Date -->
        <div class="form-row">
            <div class="form-group col-md-4">
                <label for="invoice_no">Invoice No:</label>
                <input type="text" id="invoice_no" name="invoice_no" class="form-control" placeholder="Enter Invoice No">
            </div>
            <div class="form-group col-md-4">
                <label for="invoice_date">Invoice Date:</label>
                <input type="date" id="invoice_date" name="invoice_date" class="form-control">
            </div>

            <div class="form-group col-md-4">
                <label for="supplier_name">Supplier Name:</label>
                <select id="supplier_name" name="supplier" class="form-control">
                    <option value="">Select Supplier</option>
                    {% for supplier in suppliers %}
                        <option value="{{ supplier.id }}">{{ supplier.name }}</option> 
                    {% endfor %}
                </select>
            </div>
        </div>

        <!-- Row for Item Name and Quantity -->
        <div class="form-row">
            <div class="form-group col-md-3">
                <label for="item_name">Item Name:</label>
                <select id="item_name" name="item_name" class="form-control">
                    <option value="">Select Item</option>
                    {% for item in item_dtls %}
                    <option value="{{ item.id }}">{{ item.item_name }}</option>
                    {% endfor %}
                </select>
            </div>

            <div class="form-group col-md-3">
                <label for="brand">Brand:</label>
                <input type="text" id="brand" name="brand" class="form-control" readonly>
            </div>

            <div class="form-group col-md-2">
                <label for="price">Price:</label>
                <input type="number" id="price" name="price" class="form-control" readonly>
            </div>

            <div class="form-group col-md-2">
                <label for="quantity">Quantity:</label>
                <input type="number" id="quantity" name="quantity" class="form-control" placeholder="Enter Quantity">
            </div>
            
            <div class="form-group col-md-2">
                <label for="total">Total:</label>
                <input type="number" id="total" name="total" class="form-control" readonly>
            </div>
        </div>

        <!-- Add Item Button -->
        <button type="button" id="addItem" class="btn btn-primary">Add Item</button>
    </form>

    <!-- Items List Table -->
    <h2 class="mt-5">Purchase Details</h2>
    <table id="itemsTable" class="table table-bordered mt-3">
        <thead class="thead-dark">
            <tr>
                <th>S. No</th>
                <th>Item Name</th>
                <th>Rate</th>
                <th>Quantity</th>
                <th>Total</th>
            </tr>
        </thead>
        <tbody>
        </tbody>
    </table>

    <h3>Sub Total: <span id="subTotal">0.00</span></h3>
    <br><br>
</div>
{% endblock %}
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

<script>

// console.log('dfghjkjhgfghjkkjhcvbkjhg');
// $(document).ready(function () {
//     $('#item_name').change(function () {
//         const itemId = $(this).val();
//         console.log('sdfghjklkjhgfdsdfgh')
        
//         if (itemId) {
//             $.ajax({ 
//                 type: 'POST', 
//                 url: 'get_item_detls', 
//                 data: { item_id: itemId }, 
//                 success: function (data) { 
//                     $('#brand').val(data.brand);
//                     $('#price').val(data.price);
//                     $('#total').val(data.price * $('#quantity').val()); 
//                 }
//             });
//         } else {
//             $('#brand').val('');
//             $('#price').val('');
//             $('#total').val('');
//         }
//     });
// });
</script>
